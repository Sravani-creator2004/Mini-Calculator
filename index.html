<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>calculator</title>
	
	<meta name="theme-color" content="#000000">
  </head>
  <body>
    <div class="align">
      <header><h2>Mini calculator</h2></header>
      <section class="display" aria-live="polite">
	    <div type="text"  id="history" class="history" aria-label="Previous expression"></div>
        <input type="text" id="current" class="current" id="current" aria-label="current input" value="0" disabled> <!-- to display current result -->
	  </section>
	  <section class="container" aria-label ="Calculator keypad">
	      <button class="danger" data-act="clear" arial-label="All clear(Esc)" onclick="clearDisplay()">AC</button>
		  <button class="danger" data-act="del" arial-label="Delete(Backspace)" onclick="delLast()">DEL</button>
		  <button class="op" data-val="%" arial-label="Percent" onclick="appendValue('%')">%</button>
		  <button class="op" data-val="/" arial-label="Divide" onclick="appendValue('/')">/</button>
		  
		  <button data-val="9" onclick="appendValue('9')">9</button>
		  <button data-val="8" onclick="appendValue('8')">8</button>
		  <button data-val="7" onclick="appendValue('7')">7</button>
		  <button class="op" data-val="*" arial-label="Multiply" onclick="appendValue('*')">*</button>
		  
		  <button data-val="6" onclick="appendValue('6')">6</button>
		  <button data-val="5" onclick="appendValue('5')">5</button>
		  <button data-val="4" onclick="appendValue('4')">4</button>
		  <button class="op" data-val="-" arial-label="Minus" onclick="appendValue('-')">-</button>
		  
		  <button data-val="3" onclick="appendValue('3')">3</button>
		  <button data-val="2" onclick="appendValue('2')">2</button>
		  <button data-val="1" onclick="appendValue('1')">1</button>
		  <button class="op" data-val="+" arial-label="Plus" onclick="appendValue('+')">+</button>
		  
		 
		  <button data-val="(" arial-label ="Left Parenthesis" onclick="appendValue('(')">(</button>
		  <button data-val="." arial-label ="Decimal Point" onclick="appendValue('.')">.</button>
		  <button data-val=")" arial-label ="Right Parenthesis" onclick="appendValue(')')">)</button>
		  <button class="danger" data-act="del" arial-label="Previous calculation" onclick="showPrev()">PREV</button>
		   <button data-val="0" onclick="appendValue('0')" style="grid-column: span 1;">0</button>
		  <button class="equal" data-act="=" arial-label="equals" onclick="calculate()" style="grid-column: span 2;">=</button>
		
		  <button id="darkMode" >&#127769;</button>
		   </div>
	  
	</section>
	<script>
	  let d = document.getElementById("current");
	  let history = document.getElementById("history");
	  let preCalc ="";
	  function appendValue(value){
	    const operators = ["+", "-", "*", "/", "%"];
		const lastChar = d.value.slice(-1);
	    if(d.value === "0" && !operators.includes(value)){
		   d.value="";
		  }
		  if(operators.includes(value)){
		    if(d.value === "") return;
			if(operators.includes(lastChar)){
			  d.value = d.value.slice(0,-1) + value;}
			  else { d.value += value;}
		} else{
	    d.value += value;}
	}
	function clearDisplay(){
	d.value = "0";
	}
	function delLast(){
	 d.value = d.value.slice(0,-1);
	 
	 }
	
	function calculate(){
	  try{
	    history.innerText = d.value;
		preCalc = d.value;
	    d.value = eval(d.value);
		} catch {
		 d.value ="ERROR";
		}
	}
	function showPrev(){
	 if(preCalc !== ""){
	   d.value = preCalc;
	   }
	  }
	  // Dark Mode Toggle
	  const toggleBtn = document.getElementById("darkMode");
	  toggleBtn.addEventListener("click", () =>{ document.body.classList.toggle("dark-mode");
	   if(document.body.classList.contains("dark-mode")){
	      toggleBtn.innerHTML = "&#9728;";
		  } else{
		    toggleBtn.innerHTML="&#127769;";
			}
		});
	</script>
	<script>
if ("serviceWorker" in navigator) {
navigator.serviceWorker
.register("/service-worker.js")
.then(() => console.log("Service Worker Registered"))
.catch(err => console.log("SW registration failed: ", err));
}
</script>
  </body>

</html>
